# Task: 공유 기능 재설계 및 구현

## 메타 정보
- 생성일: 2026-01-03 11:10
- 상태: 진행중
- 반복 횟수: 0

## 관련 문서
- PRD: prd.md

---

## 작업 목록

### Phase 1: 준비 단계
| 번호 | 작업 | 담당 Agent | 상태 | 결과 |
|------|------|-----------|------|------|
| 1.1 | 기존 테스트 데이터 정리 | general-purpose | 완료 | 모든 테이블 데이터 삭제 완료 |
| 1.2 | RLS 정책 재설계 및 마이그레이션 작성 | general-purpose | 완료 | 7개 테이블 RLS 정책 적용 완료 |

### Phase 2: 백엔드 구현
| 번호 | 작업 | 담당 Agent | 상태 | 결과 |
|------|------|-----------|------|------|
| 2.1 | 공유 초대 Repository 수정 | tdd-developer | 완료 | 이메일 검증, 중복 초대 방지 로직 추가 |
| 2.2 | 공유 초대 Provider 수정 | tdd-developer | 완료 | 기존 구현 유지 (이미 잘 구현됨) |
| 2.3 | 가계부 Repository 수정 | tdd-developer | 완료 | 기본 카테고리 자동 생성 로직 추가 |

### Phase 3: 프론트엔드 구현
| 번호 | 작업 | 담당 Agent | 상태 | 결과 |
|------|------|-----------|------|------|
| 3.1 | 초대하기 다이얼로그 개선 | general-purpose | 완료 | 역할별 권한 설명 추가 |
| 3.2 | 받은 초대 UI 개선 | general-purpose | 완료 | 역할 뱃지 표시 추가 |
| 3.3 | 멤버 관리 UI 개선 | general-purpose | 완료 | 가계부 나가기 기능 추가 |

### Phase 4: 검증 단계
| 번호 | 작업 | 담당 Agent | 상태 | 결과 |
|------|------|-----------|------|------|
| 4.1 | 코드 리뷰 | senior-code-reviewer | 완료 | Critical/High 이슈 수정 완료 |
| 4.2 | 에뮬레이터 통합 테스트 | app-test-agent | 완료 | RLS 데이터 격리 검증 성공 |

---

## 의존성 관계
1.1 -> 1.2 -> 2.1 -> 2.2 -> 2.3 -> 3.1 -> 3.2 -> 3.3 -> 4.1 -> 4.2

## 핵심 변경 사항

### RLS 정책 설계
- ledgers: 소유자 또는 멤버만 조회 가능
- transactions: 해당 가계부 멤버만 접근 가능
- categories: 해당 가계부 멤버만 접근 가능
- budgets: 해당 가계부 멤버만 접근 가능

### 역할별 권한
- owner: 모든 권한
- admin: 거래 CRUD + 카테고리/예산 수정 + 멤버 초대
- member: 거래 CRUD만

---

## 리뷰 피드백 히스토리
(리뷰 후 작성)

---

## 변경 로그
- 2026-01-03 11:10: 초기 생성
- 2026-01-03 12:15: 모든 Phase 완료 - RLS 적용 및 공유 기능 구현 완료
