# 수정 요구사항: 공유 가계부 멤버 수 제한

## 사용자 요청 요약

공유 가계부의 멤버 수를 **최대 2명**으로 제한합니다.
- 소유자 포함 최대 2명까지만 가계부 공유 가능
- 멤버가 가득 차면 초대 불가

---

## 사용자 선택 사항

| 항목 | 선택 |
|------|------|
| 멤버 수 표시 UI | 표시 추가 (멤버 탭에 '2/2명' 표시) |
| 초대 버튼 처리 | 비활성화 (버튼 비활성화 + 안내 메시지) |
| 기존 대기 중 초대 처리 | 수락 시 거절 (acceptInvite에서 멤버 수 확인) |

---

## 상세 요구사항

### 1. 상수 정의 (AppConstants)

**변경 사항:**
- [ ] `maxMembersPerLedger = 2` 상수 추가

---

### 2. 초대 생성 검증 (ShareRepository.createInvite)

**변경 사항:**
- [ ] 현재 멤버 수 확인 로직 추가
- [ ] 멤버 수 >= 2이면 Exception throw
- [ ] 에러 메시지: '가계부 멤버는 최대 2명까지만 가능합니다.'

---

### 3. 초대 수락 검증 (ShareRepository.acceptInvite)

**변경 사항:**
- [ ] 멤버 추가 전 멤버 수 재확인 (동시성 문제 방지)
- [ ] 멤버 수 >= 2이면 Exception throw
- [ ] 에러 메시지: '이 가계부는 이미 멤버가 가득 찼습니다.'

---

### 4. UI 개선 (ShareManagementPage)

**변경 사항:**

#### 4.1 멤버 탭 상단에 인원 표시
- [ ] AppBar 또는 리스트 상단에 '멤버 N/2명' 표시

#### 4.2 초대 버튼 (FAB) 비활성화
- [ ] 멤버 수 >= 2일 때 FAB 버튼 비활성화
- [ ] 비활성화 시 회색 처리
- [ ] 클릭 불가 상태로 변경

#### 4.3 안내 메시지
- [ ] 비활성화된 버튼 주변에 안내 텍스트 또는 SnackBar

---

## 수정 대상 파일

| 파일 | 변경 유형 | 변경 내용 |
|------|----------|----------|
| `lib/core/constants/app_constants.dart` | 수정 | maxMembersPerLedger 상수 추가 |
| `lib/features/share/data/repositories/share_repository.dart` | 수정 | createInvite, acceptInvite에 검증 추가 |
| `lib/features/share/presentation/pages/share_management_page.dart` | 수정 | 멤버 수 표시, FAB 비활성화 |

---

## 엣지 케이스 처리

### 1. 초대 생성 시 멤버가 이미 2명
- Repository에서 Exception throw
- UI에서 에러 메시지 표시

### 2. 동시에 여러 명이 초대 수락
- acceptInvite에서 멤버 추가 직전 재확인
- 이미 가득 찼으면 수락 거부

### 3. 대기 중 초대가 있는데 멤버가 가득 참
- 대기 중 초대는 유지
- 수락 시점에 멤버 수 확인하여 거부

### 4. 소유자 1명만 있을 때
- 1명 추가 초대 가능
- 2명 되면 더 이상 초대 불가

---

## UI 설계

### 멤버 탭 헤더
```
[AppBar: 공유 관리]

[멤버] [받은 초대] [보낸 초대]

멤버 2/2명  <- 인원 표시
---------------------------------
○ 소유자 (나)
○ 멤버1
```

### FAB 버튼 상태
```
// 활성화 상태 (멤버 < 2)
[+] 초대하기  (primary color)

// 비활성화 상태 (멤버 >= 2)
[+] 초대하기  (grey, disabled)
```
