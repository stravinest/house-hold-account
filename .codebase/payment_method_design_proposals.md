# 결제수단 관리 페이지 - 멤버별 관리 UI 디자인 시안

## 현황
- 공유 가계부에서 결제수단은 모든 멤버가 공유하는 단일 리스트
- 각 멤버가 자신의 결제수단을 개별적으로 관리하고 싶음

---

## 🎨 UI 디자인 시안 5가지

### **시안 1: 탭 기반 (Tab-based) - 가장 직관적**

```
┌─────────────────────────────────────┐
│ 결제수단 관리                    [+]  │
├─────────────────────────────────────┤
│ [내 결제수단]  [김철수의 결제수단]  │ ← 세그먼트 버튼
├─────────────────────────────────────┤
│                                     │
│  ▢ 신한카드      [≡] [→]           │
│  ▢ KB국민카드    [≡] [→]           │
│  ▢ 현금          [≡] [→]           │
│                                     │
│                                     │
└─────────────────────────────────────┘
```

**장점:**
- ✅ 가장 직관적이고 깔끔함
- ✅ 현재 누구의 결제수단을 보는지 명확함
- ✅ 각 탭에서 개별 관리 용이
- ✅ 추가 멤버 추가 시 탭 확장 가능

**단점:**
- ❌ 멤버 수가 많으면 탭이 많아짐
- ❌ 여러 멤버의 결제수단을 한눈에 비교 불가

**추천 상황:** 1-3명의 멤버로 구성된 공유 가계부

---

### **시안 2: 섹션 그룹화 (Section-based) - 전체 조회 가능**

```
┌─────────────────────────────────────┐
│ 결제수단 관리                    [+]  │
├─────────────────────────────────────┤
│                                     │
│ 🧑 내 결제수단                       │
│ ─────────────────────────────────   │
│  ▢ 신한카드      [≡] [→]           │
│  ▢ KB국민카드    [≡] [→]           │
│  ▢ 현금          [≡] [→]           │
│                                     │
│ 🧑 김철수의 결제수단                 │
│ ─────────────────────────────────   │
│  ▢ BC카드        [≡] [→]           │
│  ▢ 우리카드      [≡] [→]           │
│                                     │
│ 🧑 박영희의 결제수단                 │
│ ─────────────────────────────────   │
│  ▢ 삼성카드      [≡] [→]           │
│                                     │
└─────────────────────────────────────┘
```

**장점:**
- ✅ 모든 멤버의 결제수단을 한눈에 볼 수 있음
- ✅ 멤버별 결제수단 개수를 비교 가능
- ✅ 멤버 추가 시 자동으로 섹션 추가
- ✅ 스크롤로 모든 내용 조회 가능

**단점:**
- ❌ 멤버 수 많을 시 페이지가 길어짐
- ❌ 특정 멤버의 결제수단 편집 시 스크롤 필요
- ❌ 개인 가계부와 공유 가계부 구조 다름

**추천 상황:** 2-4명의 멤버로 구성된 공유 가계부

---

### **시안 3: 드롭다운 필터 (Dropdown Filter) - 간결함**

```
┌─────────────────────────────────────┐
│ 결제수단 관리                        │
├─────────────────────────────────────┤
│ 멤버 선택: [▼ 내 결제수단]      [+]  │
├─────────────────────────────────────┤
│                                     │
│  ▢ 신한카드      [≡] [→]           │
│  ▢ KB국민카드    [≡] [→]           │
│  ▢ 현금          [≡] [→]           │
│                                     │
│                                     │
│  (다른 옵션: 김철수의 결제수단,     │
│             박영희의 결제수단)       │
│                                     │
└─────────────────────────────────────┘
```

**장점:**
- ✅ UI가 매우 간결함
- ✅ 페이지가 길어지지 않음
- ✅ 한 멤버의 결제수단에 집중 가능
- ✅ 개인 가계부 UI와 유사

**단점:**
- ❌ 다른 멤버의 결제수단을 보려면 매번 선택 필요
- ❌ 멤버별 비교가 어려움
- ❌ 공유 가계부와 개인 가계부의 구조 차이가 명확하지 않음

**추천 상황:** 사용자 행동이 특정 멤버 중심적일 때

---

### **시안 4: 카드/스택 방식 (Card Stack) - 모던하고 재미있음**

```
┌─────────────────────────────────────┐
│ 결제수단 관리                        │
├─────────────────────────────────────┤
│                                     │
│  ┌─────────────────────────────┐   │
│  │ 🧑 내 결제수단       (3개)  │   │
│  │                             │   │
│  │ ▢ 신한카드   ▢ KB국민    │   │
│  │ ▢ 현금                      │   │
│  │                             │   │
│  │ [더보기] →                  │   │
│  └─────────────────────────────┘   │
│         ↓ 스와이프 또는 스크롤      │
│  ┌─────────────────────────────┐   │
│  │ 🧑 김철수의 결제수단  (2개) │   │
│  │                             │   │
│  │ ▢ BC카드    ▢ 우리카드      │   │
│  │                             │   │
│  │ [더보기] →                  │   │
│  └─────────────────────────────┘   │
│         ↓                           │
│  ┌─────────────────────────────┐   │
│  │ 🧑 박영희의 결제수단  (1개) │   │
│  │                             │   │
│  │ ▢ 삼성카드                  │   │
│  │                             │   │
│  │ [더보기] →                  │   │
│  └─────────────────────────────┘   │
│                                     │
└─────────────────────────────────────┘
```

**장점:**
- ✅ 현대적이고 매력적인 디자인
- ✅ 모든 멤버의 결제수단을 한눈에 미리볼 수 있음
- ✅ 각 멤버별로 결제수단 개수 표시
- ✅ 각 카드를 탭하여 상세 관리 가능

**단점:**
- ❌ 구현 복잡도 높음
- ❌ 많은 결제수단이 있으면 카드가 많아짐
- ❌ 반응형 디자인 어려움

**추천 상황:** 최신식 UX를 원하는 경우, 결제수단 개수가 적을 때

---

### **시안 5: 버튼 그룹 (Button Group) - 컴팩트**

```
┌─────────────────────────────────────┐
│ 결제수단 관리                    [+]  │
├─────────────────────────────────────┤
│                                     │
│ [내] [김철수] [박영희]      [≡]     │ ← 버튼 그룹
│                                     │
├─────────────────────────────────────┤
│ 내 결제수단                          │
│                                     │
│  ▢ 신한카드      [≡] [→]           │
│  ▢ KB국민카드    [≡] [→]           │
│  ▢ 현금          [≡] [→]           │
│                                     │
│ [전체보기] ←                         │
│                                     │
└─────────────────────────────────────┘
```

**장점:**
- ✅ 컴팩트하고 공간 효율적
- ✅ 빠른 멤버 전환 가능
- ✅ "전체보기" 옵션으로 모든 멤버 결제수단 조회 가능
- ✅ 탭보다 덜 주목받음 (자연스러움)

**단점:**
- ❌ 멤버가 5명 이상이면 버튼이 많아짐
- ❌ 버튼 사이즈 조정이 필요할 수 있음
- ❌ 접근성 고려 필요

**추천 상황:** 멤버 수가 가변적일 때, 간결함을 원할 때

---

## 📊 시안별 비교 표

| 항목 | 탭 방식 | 섹션 방식 | 드롭다운 | 카드 방식 | 버튼 그룹 |
|------|--------|---------|---------|---------|----------|
| **직관성** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| **멤버 수 많을 때** | ⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ |
| **전체 조회** | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| **구현 난이도** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐⭐ |
| **모바일 최적화** | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ |
| **개인화 감** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ |

---

## 🎯 추천

### **최종 추천: 시안 1 (탭 방식) + 시안 2 (섹션 방식의 옵션)**

**구현 전략:**
1. **기본: 탭 방식** 적용
   - 각 멤버별 탭으로 쉽고 빠른 전환
   - 내 결제수단, 파트너 이름으로 표시

2. **옵션: "전체보기" 탭 추가**
   - 모든 멤버 결제수단을 섹션으로 나누어 표시
   - 비교가 필요할 때 탭으로 이동

3. **화면 구성:**
```
┌─────────────────────────────────────┐
│ 결제수단 관리                    [+]  │
├─────────────────────────────────────┤
│ [내] [파트너] [전체보기]             │ ← 세그먼트 버튼
├─────────────────────────────────────┤
│ (내 결제수단 리스트)                  │
└─────────────────────────────────────┘
```

---

## 💾 데이터베이스 설계

```sql
-- payment_methods 테이블 수정
ALTER TABLE payment_methods 
ADD COLUMN user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE;

-- user_id가 NULL이면: 공유 결제수단 (구 버전)
-- user_id가 있으면: 개인 결제수단

-- RLS 정책 업데이트
CREATE POLICY "사용자는 자신의 결제수단을 볼 수 있음"
    ON payment_methods FOR SELECT
    USING (
        ledger_id IN (
            SELECT ledger_id FROM ledger_members 
            WHERE user_id = auth.uid()
        )
        AND (user_id = auth.uid() OR user_id IS NULL)
    );
```

---

## 🔧 구현 우선순위

1. ✅ **1단계**: 데이터베이스에 `user_id` 컬럼 추가
2. ✅ **2단계**: PaymentMethod 엔티티에 `userId` 속성 추가
3. ✅ **3단계**: Repository에 멤버별 조회 메서드 추가
4. ✅ **4단계**: 결제수단 관리 페이지 UI 수정 (탭 방식)
5. ✅ **5단계**: 결제수단 추가/수정 시 `user_id` 처리
6. ✅ **6단계**: 거래 추가 시 해당 사용자의 결제수단만 표시

